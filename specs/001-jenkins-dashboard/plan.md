# Implementation Plan: Jenkins Build Status Dashboard

**Branch**: `001-jenkins-dashboard` | **Date**: 2026-01-08 | **Spec**: [spec.md](./spec.md)
**Input**: Feature specification from `/specs/001-jenkins-dashboard/spec.md`

## Summary

建立一個 Jenkins Build Status Dashboard，讓 PM 和 RD 主管透過公司 SSO 登入後，在單一頁面上查看所有 Jenkins Job 的狀態和最後 Build 版本。使用 Streamlit 快速開發，整合原生 OIDC 認證和 python-jenkins 套件存取 Jenkins API。

## Technical Context

**Language/Version**: Python 3.11+
**Primary Dependencies**: Streamlit 1.32+, python-jenkins, python-dotenv
**Storage**: In-memory (Streamlit session state) + File-based audit logs
**Testing**: pytest, pytest-cov, pytest-mock
**Target Platform**: Linux server (Docker container recommended)
**Project Type**: Single web application
**Performance Goals**: Page load <3s, auto-refresh every 30 seconds
**Constraints**: API response <500ms p95, support ~100 Jenkins jobs
**Scale/Scope**: Internal tool, ~10-50 concurrent users (PM + RD Managers)

## Constitution Check

*GATE: Must pass before Phase 0 research. Re-check after Phase 1 design.*

| Principle | Requirement | Status |
|-----------|-------------|--------|
| I. Code Quality | Follows PEP8/ruff, single responsibility, explicit error handling | [x] Pass |
| II. Testing Standards | Unit tests (80%+ coverage), integration tests, contract tests planned | [x] Pass |
| III. UX Consistency | Streamlit components, accessibility, responsive design | [x] Pass |
| IV. Performance | Page load <3s, API p95 <500ms, TTI <5s targets defined | [x] Pass |

**Quality Gates**: Linting (ruff), tests (pytest), type checking (mypy), code review MUST be enforced in CI.

## Project Structure

### Documentation (this feature)

```text
specs/001-jenkins-dashboard/
├── plan.md              # This file
├── spec.md              # Feature specification
├── research.md          # Technology research and decisions
├── data-model.md        # Data entities and relationships
├── quickstart.md        # Development setup guide
├── contracts/           # API contracts
│   ├── internal-api.md  # Internal service contracts
│   └── jenkins-api-usage.md  # Jenkins API usage patterns
├── checklists/
│   └── requirements.md  # Spec quality checklist
└── tasks.md             # Implementation tasks (generated by /speckit.tasks)
```

### Source Code (repository root)

```text
src/
├── app.py               # Streamlit application entry point
├── models/
│   ├── __init__.py
│   ├── user.py          # User dataclass
│   ├── job.py           # JenkinsJob, JobStatus
│   └── state.py         # DashboardState
├── services/
│   ├── __init__.py
│   ├── auth.py          # Authentication service (SSO)
│   ├── jenkins.py       # Jenkins API service
│   ├── dashboard.py     # Dashboard state management
│   └── audit.py         # Audit logging service
└── components/
    ├── __init__.py
    ├── job_card.py      # Job status card component
    ├── status_bar.py    # Summary statistics bar
    └── job_table.py     # Job list table/grid

tests/
├── conftest.py          # Shared fixtures
├── unit/
│   ├── test_models.py
│   ├── test_auth.py
│   ├── test_jenkins_service.py
│   └── test_dashboard_service.py
├── integration/
│   └── test_jenkins_integration.py
└── contract/
    └── test_jenkins_api_contract.py

.streamlit/
└── secrets.toml         # Streamlit secrets (not in git)

pyproject.toml           # Project configuration
requirements.txt         # Dependencies
.env.example             # Environment variables template
```

**Structure Decision**: 選擇 Single project 結構，因為這是純 Python Streamlit 應用，不需要分離前後端。使用 src/ 組織原始碼，tests/ 組織測試，符合標準 Python 專案結構。

## Complexity Tracking

> No violations - design follows simplicity principles.

| Decision | Rationale | Simpler Alternative Rejected Because |
|----------|-----------|-------------------------------------|
| Streamlit over Flask | 內建 UI 元件、自動刷新、原生 SSO | Flask 需要額外前端開發，不符 YAGNI |
| In-memory cache | 單一實例、低複雜度 | Redis 過度工程化 |
| File-based audit log | 簡單、無外部依賴 | 資料庫對 audit log 過度工程化 |

## Key Technical Decisions

詳見 [research.md](./research.md)

| Decision | Choice | Key Rationale |
|----------|--------|---------------|
| Web Framework | Streamlit 1.32+ | 內建 Dashboard 元件、OIDC 支援 |
| Jenkins Client | python-jenkins | OpenStack 維護、穩定可靠 |
| Authentication | Native Streamlit OIDC | 無需額外套件 |
| Caching | @st.cache_data with TTL | 簡單有效 |

## Dependencies

### Runtime Dependencies

```
streamlit>=1.32.0
python-jenkins>=1.8.0
python-dotenv>=1.0.0
```

### Development Dependencies

```
pytest>=8.0.0
pytest-cov>=4.0.0
pytest-mock>=3.12.0
ruff>=0.2.0
mypy>=1.8.0
```

## Next Steps

1. Run `/speckit.tasks` to generate implementation task list
2. Review generated tasks and adjust priorities if needed
3. Start implementation following the task order
